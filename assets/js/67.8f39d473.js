(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{420:function(t,e,s){"use strict";s.r(e);var a=s(6),r=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"built-in-middleware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#built-in-middleware","aria-hidden":"true"}},[t._v("#")]),t._v(" Built-in middleware")]),t._v(" "),s("p",[t._v("This page documents built-in middleware that provide global behavior to Bocadillo applications. To learn more about middleware and how to write your own, see "),s("router-link",{attrs:{to:"/guide/middleware.html"}},[t._v("Middleware")]),t._v(".")],1),t._v(" "),s("h2",{attrs:{id:"cors"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cors","aria-hidden":"true"}},[t._v("#")]),t._v(" CORS")]),t._v(" "),s("p",[t._v("Bocadillo has built-in support for "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"}},[t._v("Cross-Origin Resource Sharing"),s("OutboundLink")],1),t._v(" (CORS). Adding CORS headers to HTTP responses is typically required when you are building a web service (e.g. a REST API) that web browsers should be able to request directly via AJAX/XHR.")]),t._v(" "),s("p",[t._v("To enable CORS, use the "),s("code",[t._v("CORS")]),t._v(" setting. Setting it to "),s("code",[t._v("True")]),t._v(" will enable it with restrictive defaults:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nCORS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])]),s("p",[t._v("The default CORS configuration is:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("allow_origins")]),t._v(": none.")]),t._v(" "),s("li",[s("code",[t._v("allow_methods")]),t._v(": "),s("code",[t._v("GET")])]),t._v(" "),s("li",[s("code",[t._v("allow_headers")]),t._v(": none.")])]),t._v(" "),s("p",[t._v("You'll typically need to customize the CORS configuration to suit your use case, e.g.:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nCORS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"allow_origins"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app.mysite.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"allow_methods"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"allow_headers"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("Please refer to Starlette's "),s("a",{attrs:{href:"https://www.starlette.io/middleware/#corsmiddleware",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORSMiddleware"),s("OutboundLink")],1),t._v(" documentation for the full list of options and defaults.")]),t._v(" "),s("h2",{attrs:{id:"allowed-hosts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#allowed-hosts","aria-hidden":"true"}},[t._v("#")]),t._v(" Allowed hosts")]),t._v(" "),s("p",[t._v("By default, a Bocadillo application can run on any host. To specify which hosts are allowed, use the "),s("code",[t._v("ALLOWED_HOSTS")]),t._v(" setting:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nALLOWED_HOSTS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mysite.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("If a non-allowed host is used, all requests will return a "),s("code",[t._v("400 Bad Request")]),t._v(" error.")]),t._v(" "),s("h2",{attrs:{id:"hsts-https-redirection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hsts-https-redirection","aria-hidden":"true"}},[t._v("#")]),t._v(" HSTS (HTTPS Redirection)")]),t._v(" "),s("p",[t._v("If you want to enable "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP Strict Transport Security"),s("OutboundLink")],1),t._v(" (HSTS) to redirect all HTTP traffic to HTTPS (or WS to WSS), use:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nHSTS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])]),s("div",{staticClass:"warning custom-block"},[s("p",[t._v("You should only enable HSTS if you have HTTPS configured on your server. See also the "),s("router-link",{attrs:{to:"/discussions/security.html#https"}},[t._v("Security: HTTPS")]),t._v(" guide.")],1)]),t._v(" "),s("h2",{attrs:{id:"gzip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gzip","aria-hidden":"true"}},[t._v("#")]),t._v(" GZip")]),t._v(" "),s("p",[t._v("If you want to enable "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding#Directives",target:"_blank",rel:"noopener noreferrer"}},[t._v("GZip compression"),s("OutboundLink")],1),t._v(" to compress HTTP responses when possible, use:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nGZIP "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])]),s("p",[t._v("You can also specify the minimum bytes the response should have before compressing:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myproject/settings.py")]),t._v("\nGZIP "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\nGZIP_MIN_SIZE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Default")]),t._v("\n")])])])])},[],!1,null,null,null);e.default=r.exports}}]);