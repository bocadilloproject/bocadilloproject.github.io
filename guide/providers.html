<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Providers | Bocadillo</title>
    <meta name="description" content="Fast, scalable and real-time capable web APIs for everyone: Bocadillo is a Python asynchronous web framework built with productivity and modularity in mind.">
    <link rel="stylesheet" href="/octicons.css">
  <link rel="shortcut icon" href="/favicon.ico?v=lk90Ny5lbz">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=lk90Ny5lbz">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=lk90Ny5lbz">
  <link rel="manifest" href="/site.webmanifest?v=lk90Ny5lbz">
  <meta name="theme-color" content="#ffe66b">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=lk90Ny5lbz">
  <link rel="mask-icon" href="/safari-pinned-tab.svg?v=lk90Ny5lbz" color="#91ba3f">
  <meta name="msapplication-TileColor" content="#ef9a4d">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:url" content="https://bocadilloproject.github.io">
  <meta name="twitter:title" content="Bocadillo">
  <meta name="twitter:site" content="@bocadillopy">
  <meta name="twitter:creator" content="Florimond Manca">
  <meta name="twitter:description" content="Fast, scalable and real-time capable web APIs for everyone: Bocadillo is a Python asynchronous web framework built with productivity and modularity in mind.">
  <meta name="twitter:image" content="https://bocadilloproject.github.io/logo.png">
  <meta name="google-site-verification" content="xbJzBKn7IuLWAUKvqHo1c3vMelw3eTRL0k3JcKjYB_k">
    
    <link rel="preload" href="/assets/css/0.styles.1610f5ec.css" as="style"><link rel="preload" href="/assets/js/app.ef5a74fe.js" as="script"><link rel="preload" href="/assets/js/2.741e5c13.js" as="script"><link rel="preload" href="/assets/js/22.60c6ec4e.js" as="script"><link rel="preload" href="/assets/js/77.664fe172.js" as="script"><link rel="preload" href="/assets/js/23.fecdc752.js" as="script"><link rel="prefetch" href="/assets/js/1.28623c5a.js"><link rel="prefetch" href="/assets/js/10.9e1006c4.js"><link rel="prefetch" href="/assets/js/100.764c96c8.js"><link rel="prefetch" href="/assets/js/101.79200541.js"><link rel="prefetch" href="/assets/js/102.2e1407e3.js"><link rel="prefetch" href="/assets/js/103.7830dd4a.js"><link rel="prefetch" href="/assets/js/104.52455b7e.js"><link rel="prefetch" href="/assets/js/105.fa552a9f.js"><link rel="prefetch" href="/assets/js/106.81313cd4.js"><link rel="prefetch" href="/assets/js/11.bdeaccad.js"><link rel="prefetch" href="/assets/js/12.fea470ff.js"><link rel="prefetch" href="/assets/js/13.39d7df02.js"><link rel="prefetch" href="/assets/js/14.c9927eee.js"><link rel="prefetch" href="/assets/js/15.87e26629.js"><link rel="prefetch" href="/assets/js/16.6281a5f1.js"><link rel="prefetch" href="/assets/js/17.3dc8666b.js"><link rel="prefetch" href="/assets/js/18.b93d182a.js"><link rel="prefetch" href="/assets/js/19.8093f59d.js"><link rel="prefetch" href="/assets/js/20.f6778ebc.js"><link rel="prefetch" href="/assets/js/21.83002d33.js"><link rel="prefetch" href="/assets/js/24.6ab6ed9a.js"><link rel="prefetch" href="/assets/js/25.3476451e.js"><link rel="prefetch" href="/assets/js/26.be460c24.js"><link rel="prefetch" href="/assets/js/27.78500487.js"><link rel="prefetch" href="/assets/js/28.df3b3176.js"><link rel="prefetch" href="/assets/js/29.171eca5b.js"><link rel="prefetch" href="/assets/js/30.27a29de9.js"><link rel="prefetch" href="/assets/js/31.c1e5ed6c.js"><link rel="prefetch" href="/assets/js/32.43e6bd89.js"><link rel="prefetch" href="/assets/js/33.47234724.js"><link rel="prefetch" href="/assets/js/34.8f883d10.js"><link rel="prefetch" href="/assets/js/35.886bf2d6.js"><link rel="prefetch" href="/assets/js/36.d74a4b45.js"><link rel="prefetch" href="/assets/js/37.5f147823.js"><link rel="prefetch" href="/assets/js/38.6882e29b.js"><link rel="prefetch" href="/assets/js/39.b016911e.js"><link rel="prefetch" href="/assets/js/4.9e306066.js"><link rel="prefetch" href="/assets/js/40.2fc0e4ef.js"><link rel="prefetch" href="/assets/js/41.3f8233d4.js"><link rel="prefetch" href="/assets/js/42.bb51a16e.js"><link rel="prefetch" href="/assets/js/43.64c511ad.js"><link rel="prefetch" href="/assets/js/44.2fd79fd9.js"><link rel="prefetch" href="/assets/js/45.ef1889bb.js"><link rel="prefetch" href="/assets/js/46.faed4535.js"><link rel="prefetch" href="/assets/js/47.c5a1fd71.js"><link rel="prefetch" href="/assets/js/48.3f137c5f.js"><link rel="prefetch" href="/assets/js/49.107fe3f3.js"><link rel="prefetch" href="/assets/js/5.6d0d80f9.js"><link rel="prefetch" href="/assets/js/50.16babc94.js"><link rel="prefetch" href="/assets/js/51.a761ac95.js"><link rel="prefetch" href="/assets/js/52.b3da75d6.js"><link rel="prefetch" href="/assets/js/53.cb224ef5.js"><link rel="prefetch" href="/assets/js/54.5fd0de3b.js"><link rel="prefetch" href="/assets/js/55.c68c0838.js"><link rel="prefetch" href="/assets/js/56.b86c9cfc.js"><link rel="prefetch" href="/assets/js/57.9a875cd5.js"><link rel="prefetch" href="/assets/js/58.d25974a5.js"><link rel="prefetch" href="/assets/js/59.4229b9d5.js"><link rel="prefetch" href="/assets/js/6.9de27215.js"><link rel="prefetch" href="/assets/js/60.190f9994.js"><link rel="prefetch" href="/assets/js/61.a6787cb1.js"><link rel="prefetch" href="/assets/js/62.55269a82.js"><link rel="prefetch" href="/assets/js/63.d16c0a81.js"><link rel="prefetch" href="/assets/js/64.de71f4d5.js"><link rel="prefetch" href="/assets/js/65.ec533d3e.js"><link rel="prefetch" href="/assets/js/66.3ca3058a.js"><link rel="prefetch" href="/assets/js/67.8f39d473.js"><link rel="prefetch" href="/assets/js/68.5f1bfdf2.js"><link rel="prefetch" href="/assets/js/69.8a5ee484.js"><link rel="prefetch" href="/assets/js/7.baf0b149.js"><link rel="prefetch" href="/assets/js/70.cae2620c.js"><link rel="prefetch" href="/assets/js/71.88c976be.js"><link rel="prefetch" href="/assets/js/72.0608759c.js"><link rel="prefetch" href="/assets/js/73.30825c52.js"><link rel="prefetch" href="/assets/js/74.f3a4653a.js"><link rel="prefetch" href="/assets/js/75.f076bac4.js"><link rel="prefetch" href="/assets/js/76.b9cf5ea6.js"><link rel="prefetch" href="/assets/js/78.bb705f3f.js"><link rel="prefetch" href="/assets/js/79.755a16c1.js"><link rel="prefetch" href="/assets/js/8.1430bdec.js"><link rel="prefetch" href="/assets/js/80.3b3c943c.js"><link rel="prefetch" href="/assets/js/81.8dfcf1f4.js"><link rel="prefetch" href="/assets/js/82.e0d8b8bf.js"><link rel="prefetch" href="/assets/js/83.8e788d4e.js"><link rel="prefetch" href="/assets/js/84.e62a4140.js"><link rel="prefetch" href="/assets/js/85.7de9077f.js"><link rel="prefetch" href="/assets/js/86.36b0b794.js"><link rel="prefetch" href="/assets/js/87.88eaed47.js"><link rel="prefetch" href="/assets/js/88.12e8bfee.js"><link rel="prefetch" href="/assets/js/89.79671657.js"><link rel="prefetch" href="/assets/js/9.fff42a24.js"><link rel="prefetch" href="/assets/js/90.7770f14c.js"><link rel="prefetch" href="/assets/js/91.34595596.js"><link rel="prefetch" href="/assets/js/92.d0e2a53f.js"><link rel="prefetch" href="/assets/js/93.0dd1d80f.js"><link rel="prefetch" href="/assets/js/94.224315b4.js"><link rel="prefetch" href="/assets/js/95.6a720b9e.js"><link rel="prefetch" href="/assets/js/96.f8e2cc61.js"><link rel="prefetch" href="/assets/js/97.6ace73bc.js"><link rel="prefetch" href="/assets/js/98.3851eb39.js"><link rel="prefetch" href="/assets/js/99.4f065790.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1610f5ec.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Bocadillo</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/how-to/" class="nav-link">How-To</a></div><div class="nav-item"><a href="/discussions/" class="nav-link">Discussions</a></div><div class="nav-item"><a href="/api/" class="nav-link">Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Ecosystem</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Tooling</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject/bocadillo-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Bocadillo CLI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>Help</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/faq.html" class="nav-link">FAQ</a></li><li class="dropdown-subitem"><a href="/troubleshooting.html" class="nav-link">Troubleshooting</a></li></ul></li><li class="dropdown-item"><h4>News</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://twitter.com/bocadillopy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/news/" class="nav-link">News</a></li><li class="dropdown-subitem"><a href="/mentions.html" class="nav-link">Mentions</a></li></ul></li><li class="dropdown-item"><h4>Resources</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject/bocadillo/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://pypi.org/project/bocadillo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PyPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official repos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/bocadilloproject/bocadillo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link router-link-active">Guide</a></div><div class="nav-item"><a href="/how-to/" class="nav-link">How-To</a></div><div class="nav-item"><a href="/discussions/" class="nav-link">Discussions</a></div><div class="nav-item"><a href="/api/" class="nav-link">Reference</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Ecosystem</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Tooling</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject/bocadillo-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Bocadillo CLI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li><li class="dropdown-item"><h4>Help</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/faq.html" class="nav-link">FAQ</a></li><li class="dropdown-subitem"><a href="/troubleshooting.html" class="nav-link">Troubleshooting</a></li></ul></li><li class="dropdown-item"><h4>News</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://twitter.com/bocadillopy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="/news/" class="nav-link">News</a></li><li class="dropdown-subitem"><a href="/mentions.html" class="nav-link">Mentions</a></li></ul></li><li class="dropdown-item"><h4>Resources</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject/bocadillo/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Changelog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://pypi.org/project/bocadillo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  PyPI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-subitem"><a href="https://github.com/bocadilloproject" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official repos
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul></div></div> <a href="https://github.com/bocadilloproject/bocadillo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/guide/" class="sidebar-link">Introduction</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Essentials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Built-in features</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Real-Time Web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Reusability &amp; Modularity</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide/nested-apps.html" class="sidebar-link">Nested applications</a></li><li><a href="/guide/routers.html" class="sidebar-link">Routers</a></li><li><a href="/guide/providers.html" class="active sidebar-link">Providers</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/providers.html#example" class="sidebar-link">Example</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#scopes" class="sidebar-link">Scopes</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#modularity" class="sidebar-link">Modularity</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#auto-used-providers" class="sidebar-link">Auto-used providers</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#decorator-usage" class="sidebar-link">Decorator usage</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#factory-providers" class="sidebar-link">Factory providers</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#how-are-providers-discovered" class="sidebar-link">How are providers discovered?</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#naming-providers" class="sidebar-link">Naming providers</a></li><li class="sidebar-sub-header"><a href="/guide/providers.html#lazy-evaluation" class="sidebar-link">Lazy evaluation</a></li></ul></li><li><a href="/guide/plugins.html" class="sidebar-link">Plugins</a></li><li><a href="/guide/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/guide/middleware.html" class="sidebar-link">Middleware</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tooling</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="content deprecation-warning" style="margin:1rem;margin-top:4.6rem;" data-v-b1b05e82><p data-v-b1b05e82><strong data-v-b1b05e82>Warning:</strong> Bocadillo is now <strong data-v-b1b05e82>UNMAINTAINED</strong>.
    Users are recommended to migrate to a supported alternative, such as
    <a href="https://www.starlette.io" target="_blank" rel="noreferrer" data-v-b1b05e82>Starlette</a>
    or
    <a href="https://fastapi.tiangolo.com" target="_blank" rel="noreferrer" data-v-b1b05e82>FastAPI</a>. Please see
    <a href="https://github.com/bocadilloproject/bocadillo/issues/334" target="_blank" rel="noreferrer" data-v-b1b05e82>#344</a>
    for more information.
  </p></div> <div class="theme-default-content content__default"><h1 id="providers"><a href="#providers" aria-hidden="true" class="header-anchor">#</a> Providers <span class="badge warn" style="vertical-align:top;" data-v-c13ee5b0>Experimental</span> <span class="badge tip" style="vertical-align:top;" data-v-c13ee5b0>0.13+</span></h1> <p><strong>Providers</strong> solve the problem of injecting reusable resources into HTTP and WebSocket views in an explicit, modular and async-capable manner, without having to rely on global variables or numerous import statements.</p> <p>In practice, you can view providers as a <strong>runtime dependency injection system</strong>.</p> <p>The API for providers was heavily influenced by <a href="https://docs.pytest.org/en/latest/provider.html" target="_blank" rel="noopener noreferrer">pytest fixtures<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, so it should feel fairly familiar. Also, their core implementation was extracted into a separate, officially supported package: <a href="https://github.com/bocadilloproject/aiodine" target="_blank" rel="noopener noreferrer">aiodine<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="example"><a href="#example" aria-hidden="true" class="header-anchor">#</a> Example</h2> <p>Suppose we want to implement a cache system backed by <a href="https://redis.io" target="_blank" rel="noopener noreferrer">Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, a distributed key-value store, using the <a href="https://github.com/aio-libs/aioredis" target="_blank" rel="noopener noreferrer">aioredis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library. How would we make a Redis connection available to views?</p> <p>The naive solution would be to create a <code>redis</code> global variable, initially <code>None</code>, and then use <a href="/guide/apps.html#lifespan-events">lifespan handlers</a> to give it a value on app startup. It's hacky, and definitely not very testable. Instead, let's use providers!</p> <p>Let's start by adding a <code>REDIS_URL</code> setting to the settings module:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/settings.py</span>
<span class="token keyword">from</span> starlette<span class="token punctuation">.</span>config <span class="token keyword">import</span> Config

config <span class="token operator">=</span> Config<span class="token punctuation">(</span><span class="token string">&quot;.env&quot;</span><span class="token punctuation">)</span>

PROVIDER_MODULES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;myproject.providerconf&quot;</span><span class="token punctuation">]</span>
REDIS_URL <span class="token operator">=</span> config<span class="token punctuation">(</span><span class="token string">&quot;REDIS_URL&quot;</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">&quot;redis://localhost&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>We can now define the <code>redis</code> provider. Since we registered <code>myproject.providerconf</code> in <code>PROVIDER_MODULES</code>, let's place the provider there:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">import</span> aioredis
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider<span class="token punctuation">,</span> settings

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">redis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    conn <span class="token operator">=</span> <span class="token keyword">await</span> aioredis<span class="token punctuation">.</span>create_redis<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>REDIS_URL<span class="token punctuation">)</span>
    <span class="token keyword">yield</span> conn
    <span class="token keyword">await</span> conn<span class="token punctuation">.</span>wait_closed<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Thanks to this code, if a request is made to your application, and the view asked for the <code>redis</code> provider (more on that shortly), here's what happens:</p> <ol><li>Bocadillo executes everything above the <code>yield</code> statement. In this case, it connects to Redis and creates the connection object.</li> <li>The <code>yield</code>ed object (here, the Redis connection) is passed to the view as a keyword argument.</li> <li>When the view has finished (and even if an exception occurred), Bocadillo executes everything after the <code>yield</code> statement. In this case, it closes the Redis connection.</li></ol> <div class="tip custom-block"><p>It is not mandatory that a provider uses <code>yield</code>. If no cleanup is required, it can also simply <code>return</code>:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@provider</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, world!&quot;</span>
</code></pre></div></div> <p>Now, how can we use the <code>redis</code> provider in a view?</p> <p>Simple enough: <strong>by declaring it as a view parameter</strong>.</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/value&quot;</span><span class="token punctuation">)</span>           👇
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_value</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> redis<span class="token punctuation">)</span><span class="token punctuation">:</span>
    value <span class="token operator">=</span> <span class="token keyword">await</span> redis<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;some-key&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> value <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        value <span class="token operator">=</span> <span class="token number">42</span>
        <span class="token keyword">await</span> redis<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">&quot;some-key&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
    res<span class="token punctuation">.</span>json <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span> value<span class="token punctuation">}</span>
</code></pre></div><p>An important principle behind providers is <em>Define once, reuse everywere</em>: we could also access the Redis cache in other REST endpoints, or in a WebSocket endpoint:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/valuefeed&quot;</span><span class="token punctuation">)</span>  👇
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">value_feed</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> redis<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">for</span> message <span class="token keyword">in</span> ws<span class="token punctuation">:</span>
        value <span class="token operator">=</span> <span class="token keyword">await</span> redis<span class="token punctuation">.</span>get<span class="token punctuation">(</span>message<span class="token punctuation">[</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">await</span> ws<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">:</span> value<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">SEE ALSO</p> <p>The <a href="/guide/tutorial.html">tutorial</a> shows how to use providers and WebSocket to implement a real-time chatbot server.</p></div> <h2 id="scopes"><a href="#scopes" aria-hidden="true" class="header-anchor">#</a> Scopes</h2> <p>By default, a provider is computed on each request. But some providers are typically expansive to setup and teardown, or could gain from being reused across requests. In the previous example, we may want to reuse the Redis connection throughout the lifespan of the application.</p> <p>For this reason, Bocadillo providers have two possible <strong>scopes</strong>:</p> <ul><li><code>request</code>: a new copy of the provider is computed for each HTTP request or WebSocket connection. This is the default behavior.</li> <li><code>app</code>: the provided value is reused and shared between requests.</li></ul> <p>The <code>app</code> scope can be used to implement <strong>long-lived objects</strong>, i.e. objects which Bocadillo initialises and reuses for as long as the app is running.</p> <p>For example, you could keep track of connected WebSocket clients via an app-scoped provider which initially returns an empty set:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider<span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">clients</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">set</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>and then register/unregister clients as they connect/disconnect to the WebSocket endpoint:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>websocket_route</span><span class="token punctuation">(</span><span class="token string">&quot;/echo&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">echo</span><span class="token punctuation">(</span>ws<span class="token punctuation">,</span> clients<span class="token punctuation">:</span> <span class="token builtin">set</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    clients<span class="token punctuation">.</span>add<span class="token punctuation">(</span>ws<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">async</span> <span class="token keyword">for</span> message <span class="token keyword">in</span> ws<span class="token punctuation">:</span>
            <span class="token keyword">await</span> ws<span class="token punctuation">.</span>send<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        clients<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>ws<span class="token punctuation">)</span>
</code></pre></div><h2 id="modularity"><a href="#modularity" aria-hidden="true" class="header-anchor">#</a> Modularity</h2> <p>Providers are <strong>modular</strong>, in the sense that <strong>providers can be injected into other providers</strong>. This allows to build an ecosystem of loosely-coupled, reusable resources.</p> <p>A contrived example of this could be:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">message_format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;{greeting}, {who}&quot;</span>

<span class="token decorator annotation punctuation">@provider</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">hello_message_format</span><span class="token punctuation">(</span>message_format<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> message_format<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>greeting<span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>As you can see, <code>hello_message_format</code> reuses the <code>message_format</code> provider.</p> <h2 id="auto-used-providers"><a href="#auto-used-providers" aria-hidden="true" class="header-anchor">#</a> Auto-used providers</h2> <p>If you want the provider to be activated without explicitly declaring it as a parameter of a view, use <code>autouse=True</code>.</p> <p>For example, you can make sure that database calls are always performed within a transaction. Using the <a href="https://github.com/encode/databases" target="_blank" rel="noopener noreferrer">Databases<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library, this could be implemented by creating a <code>db</code> provider first:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">from</span> databases <span class="token keyword">import</span> Database
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider<span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> Database<span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> Database<span class="token punctuation">(</span><span class="token string">&quot;sqlite://:memory:&quot;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>
        <span class="token keyword">yield</span> db
</code></pre></div><p>And then creating another <strong>auto-used provider</strong> which automatically sets up a transaction:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token decorator annotation punctuation">@provider</span><span class="token punctuation">(</span>autouse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">transaction</span><span class="token punctuation">(</span>db<span class="token punctuation">:</span> Database<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">with</span> db<span class="token punctuation">.</span>transaction<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span>
</code></pre></div><h2 id="decorator-usage"><a href="#decorator-usage" aria-hidden="true" class="header-anchor">#</a> Decorator usage</h2> <p>If you don't actually need the value returned by the provider, you can decorate the consumer view with the <code>@useprovider</code> decorator:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token decorator annotation punctuation">@provider</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;show_hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">provide_show_hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, providers!&quot;</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/hi&quot;</span><span class="token punctuation">)</span>
@useprovider<span class="token punctuation">(</span><span class="token string">&quot;show_hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">say_hi</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">&quot;A hello message was printed to the console.&quot;</span>
</code></pre></div><div class="tip custom-block"><ul><li>The <code>@useprovider</code> decorator accepts a variable number of providers.</li> <li>Providers can be passed by name or by reference.</li></ul></div> <h2 id="factory-providers"><a href="#factory-providers" aria-hidden="true" class="header-anchor">#</a> Factory providers</h2> <p>Factory providers are a <strong>design pattern</strong> that allows to build generic providers that can be used for a variety of inputs.</p> <p>tl;dr: instead of returning a value, the provider returns a <strong>function</strong>.</p> <p>As an example, let's build a factory provider that retrieves a note item from the database given its primary key. We'll use a hardcoded in-memory database of sticky notes for the sake of simplicity:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider<span class="token punctuation">(</span>scope<span class="token operator">=</span><span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">notes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># TODO: get these from a database</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Groceries&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Make potatoe smash&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_note</span><span class="token punctuation">(</span>notes<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">_get_note</span><span class="token punctuation">(</span>pk<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>
        note <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>note <span class="token keyword">for</span> note <span class="token keyword">in</span> notes <span class="token keyword">if</span> note<span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> pk<span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> note <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> HTTPError<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">,</span> detail<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;Note with ID </span><span class="token interpolation"><span class="token punctuation">{</span>pk<span class="token punctuation">}</span></span><span class="token string"> does not exist.&quot;</span></span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> note

    <span class="token keyword">return</span> _get_note
</code></pre></div><p>Example usage:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/notes/{pk}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">retrieve_note</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> pk<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> get_note<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token punctuation">.</span>json <span class="token operator">=</span> <span class="token keyword">await</span> get_note<span class="token punctuation">(</span>pk<span class="token punctuation">)</span>
</code></pre></div><h2 id="how-are-providers-discovered"><a href="#how-are-providers-discovered" aria-hidden="true" class="header-anchor">#</a> How are providers discovered?</h2> <p>Bocadillo can find providers from a number of sources:</p> <ol><li><strong>(Recommended)</strong> Functions decorated with <code>@provider</code> that live in a module listed in the <code>PROVIDER_MODULES</code> setting. This is what <a href="https://github.com/bocadilloproject/bocadillo-cli" target="_blank" rel="noopener noreferrer">Bocadillo CLI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> generates.</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/settings.py</span>
PROVIDER_MODULES <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;myproject.providerconf&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;myproject.more_providers&quot;</span><span class="token punctuation">]</span>
</code></pre></div><ol start="2"><li>Functions decorated with <code>@provider</code> that live in a module marked for discovery using <code>discover_providers()</code>.</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> discover_providers

discover_providers<span class="token punctuation">(</span><span class="token string">&quot;myproject.more_providers&quot;</span><span class="token punctuation">)</span>
</code></pre></div><ol start="3"><li>Functions decorated with <code>@provider</code> that live in a <code>providerconf.py</code> module relative to the current working directory (note that this may be different from the directory where <code>app.py</code> is located).</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># providerconf.py</span>
<span class="token keyword">import</span> random <span class="token keyword">as</span> _random
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">float</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> _random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>Functions decorated with <code>@provider</code> present in the application script:</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> App<span class="token punctuation">,</span> provider

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, providers!&quot;</span>

app <span class="token operator">=</span> App<span class="token punctuation">(</span><span class="token punctuation">)</span>

@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">&quot;/hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">hello</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token punctuation">.</span>json <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">:</span> message<span class="token punctuation">}</span>
</code></pre></div><ol start="5"><li>Functions decorated with <code>@provider</code> that get <em>imported</em> in the application script:</li></ol> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/messages.py</span>
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, providers!&quot;</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> messages
</code></pre></div><h2 id="naming-providers"><a href="#naming-providers" aria-hidden="true" class="header-anchor">#</a> Naming providers <span class="badge warn" style="vertical-align:top;" data-v-c13ee5b0>Advanced</span></h2> <p>By default, a provider's name is the same as that of its defining function, but you can override it with the <code>name</code> parameter to <code>@provider</code>.</p> <p>When the provider is declared and used <em>in the same file</em>, linters and IDEs may complain because of conflicting names. A good convention is then to name the provider function as <code>provide_{name}</code>. For example:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token decorator annotation punctuation">@provider</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">provide_hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Hello, providers!&quot;</span>
</code></pre></div><h2 id="lazy-evaluation"><a href="#lazy-evaluation" aria-hidden="true" class="header-anchor">#</a> Lazy evaluation <span class="badge warn" style="vertical-align:top;" data-v-c13ee5b0>Advanced</span></h2> <p>By default, Bocadillo awaits the coroutine returned by the provider before passing it to the view. (Note: if this is gibberish, take a look at the <a href="/guide/async.html">Async crash course</a>.)</p> <p>If you need to defer awaiting the provider until you really need it, you can declare it as <code>lazy</code>. The following example uses the <a href="https://github.com/encode/requests-async" target="_blank" rel="noopener noreferrer">requests-async<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> library:</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/providerconf.py</span>
<span class="token keyword">import</span> requests_async <span class="token keyword">as</span> requests
<span class="token keyword">from</span> bocadillo <span class="token keyword">import</span> provider

@provider<span class="token punctuation">(</span>lazy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">random_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    r <span class="token operator">=</span> <span class="token keyword">await</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">&quot;https://httpbin.org/json&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># myproject/app.py</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">&quot;/data&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_data</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> random_data<span class="token punctuation">:</span> Awaitable<span class="token punctuation">[</span><span class="token builtin">dict</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token punctuation">.</span>json <span class="token operator">=</span> random_data
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">CAVEAT</p> <p>Lazy providers can only be <strong>request-scoped</strong>. If they could be app-scoped, Bocadillo would have no way to know whether it has already been awaited when processing another request.</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/bocadilloproject/bocadillo/edit/release/docs/docs/guide/providers.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/25/2019, 7:51:53 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/guide/routers.html" class="prev">
          Routers
        </a></span> <span class="next"><a href="/guide/plugins.html">
          Plugins
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ef5a74fe.js" defer></script><script src="/assets/js/2.741e5c13.js" defer></script><script src="/assets/js/22.60c6ec4e.js" defer></script><script src="/assets/js/77.664fe172.js" defer></script><script src="/assets/js/23.fecdc752.js" defer></script>
  </body>
</html>
