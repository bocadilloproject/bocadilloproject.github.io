(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{423:function(t,a,s){"use strict";s.r(a);var e=s(6),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"routing"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#routing","aria-hidden":"true"}},[t._v("#")]),t._v(" Routing")]),t._v(" "),s("p",[t._v("Bocadillo makes it very easy to handle HTTP requests, i.e. mapping URL patterns to views.")]),t._v(" "),s("h2",{attrs:{id:"overview"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[t._v("#")]),t._v(" Overview")]),t._v(" "),s("p",[t._v("In Bocadillo, "),s("strong",[t._v("routes")]),t._v(" map an "),s("strong",[t._v("URL pattern")]),t._v(" to a "),s("strong",[t._v("view")]),t._v(", which can be a function or a class. When an application receives a request, its router invokes the view for the matching route which generates the response.")]),t._v(" "),s("h2",{attrs:{id:"how-are-requests-processed"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-are-requests-processed","aria-hidden":"true"}},[t._v("#")]),t._v(" How are requests processed?")]),t._v(" "),s("p",[t._v("When an inbound HTTP request hits your Bocadillo application, the following algorithm is used to determine which view gets executed:")]),t._v(" "),s("ol",[s("li",[t._v("Bocadillo runs through each URL pattern and stops at the first matching one, extracting the raw route parameters as well. If none can be found, an "),s("code",[t._v("HTTPError(404)")]),t._v(" is raised.")]),t._v(" "),s("li",[t._v("Bocadillo checks that the matching route supports the requested HTTP method, and raises an "),s("code",[t._v("HTTPError(405)")]),t._v(" exception if it does not.")]),t._v(" "),s("li",[t._v("When this is done, Bocadillo calls the view attached to the route. If any of the route parameters fails validation, an "),s("code",[t._v("HTTPError(400)")]),t._v(" exception is raised.")]),t._v(" "),s("li",[t._v("If no pattern matches, or if an exception is raised in the process, Bocadillo invokes an appropriate error handler (see "),s("a",{attrs:{href:"#route-error-handling"}},[t._v("Route error handling")]),t._v(" below).")])]),t._v(" "),s("p",[t._v("The router searches against the requested "),s("strong",[t._v("URL path")]),t._v(". This does not include the domain name nor query parameters.")]),t._v(" "),s("h3",{attrs:{id:"about-trailing-slashes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#about-trailing-slashes","aria-hidden":"true"}},[t._v("#")]),t._v(" About trailing slashes "),s("Badge",{attrs:{type:"warn",text:"Advanced"}})],1),t._v(" "),s("p",[t._v("When no route matches the requested URL path, and the URL path does not contain a trailing slash, Bocadillo will add it and send a temporary redirect (302) response. The client will then automatically perform a new request, and the routing algorithm starts again.")]),t._v(" "),s("p",[t._v("For example, if "),s("code",[t._v("/items")]),t._v(" did not match any route, the client will be redirected to "),s("code",[t._v("/items/")]),t._v(". If no route matches "),s("code",[t._v("/items/")]),t._v(", an "),s("code",[t._v("HTTPError(404)")]),t._v(" exception is raised.")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",[t._v("Please note that when this happen, "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS/Errors/CORSExternalRedirectNotAllowed",target:"_blank",rel:"noopener noreferrer"}},[t._v("CORS pre-flight requests will fail"),s("OutboundLink")],1),t._v(". For this reason, make sure to use a trailing slash when requesting your Bocadillo API from a web browser.")])]),t._v(" "),s("p",[t._v("To disable this behavior, use the "),s("code",[t._v("REDIRECT_TRAILING_SLASH")]),t._v(" setting:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# settings.py")]),t._v("\nREDIRECT_TRAILING_SLASH "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n")])])]),s("h2",{attrs:{id:"routes-examples"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#routes-examples","aria-hidden":"true"}},[t._v("#")]),t._v(" Routes examples")]),t._v(" "),s("p",[t._v("Here are a few example routes:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App\n\napp "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("home")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items/42"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_item_42")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items/{pk}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_items")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),s("p",[t._v("Note that:")]),t._v(" "),s("ul",[s("li",[t._v("An URL pattern should start with a leading slash.")]),t._v(" "),s("li",[t._v("Bocadillo honors the presence or absence of a trailing slash on the URL. It will not perform any redirection by default.")]),t._v(" "),s("li",[t._v("Route parameters are passed as keyword arguments to the view.")])]),t._v(" "),s("p",[t._v("Here's how a few example requests would be handled:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Requested URL path")]),t._v(" "),s("th",[t._v("Matched route")]),t._v(" "),s("th",[t._v("Reason")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("/")])]),t._v(" "),s("td",[s("code",[t._v("home()")])]),t._v(" "),s("td",[t._v("Only matching route.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("/items/13")])]),t._v(" "),s("td",[s("code",[t._v("get_items()")])]),t._v(" "),s("td",[t._v("Only matching route.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("/items/42")])]),t._v(" "),s("td",[s("code",[t._v("get_item_42()")])]),t._v(" "),s("td",[t._v("First route to match.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("/items/foo")])]),t._v(" "),s("td",[t._v("None")]),t._v(" "),s("td",[s("code",[t._v("get_items()")]),t._v(" requires "),s("code",[t._v("pk")]),t._v(" to be an integer.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("/items/13/detail")])]),t._v(" "),s("td",[t._v("None")]),t._v(" "),s("td",[t._v("No matching route*.")])])])]),t._v(" "),s("p",[s("em",[t._v("* Route parameters search in individual URL parts. If you want to match entire sections of the URL, see "),s("a",{attrs:{href:"#path-like-route-parameters"}},[t._v("Path-like route parameters")]),t._v(".")])]),t._v(" "),s("h2",{attrs:{id:"function-based-views"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#function-based-views","aria-hidden":"true"}},[t._v("#")]),t._v(" Function-based views")]),t._v(" "),s("p",[t._v("A route maps an URL pattern to a "),s("strong",[t._v("view")]),t._v(". A view consists in an "),s("strong",[t._v("asynchronous function")]),t._v(" that takes as input the request ("),s("code",[t._v("req")]),t._v(" by convention), the response ("),s("code",[t._v("res")]),t._v(" by convention), and any keyword arguments obtained from route or query parameters (more on this in the next sections).")]),t._v(" "),s("p",[t._v("We've already used function-based views in the examples above. One thing to remember is that "),s("strong",[t._v("views must be asynchronous")]),t._v(", i.e. defined with the "),s("code",[t._v("async def")]),t._v(" syntax. This allows you to call arbitrary async code in views, e.g.:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" asyncio\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find_post_content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("slug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" asyncio"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sleep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# perhaps query a database here?")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"My awesome post"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/post/{slug}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("retrieve_post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" slug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" find_post_content"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("slug"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"class-based-views"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#class-based-views","aria-hidden":"true"}},[t._v("#")]),t._v(" Class-based views")]),t._v(" "),s("p",[t._v("Bocadillo also supports "),s("strong",[t._v("class-based views")]),t._v(". Incoming requests get dispatched to the method on the class named after the requested HTTP method. For example, "),s("code",[t._v("GET")]),t._v(" is dispatched to "),s("code",[t._v(".get()")]),t._v(", "),s("code",[t._v("POST")]),t._v(" is dispatched to "),s("code",[t._v(".post()")]),t._v(", etc. Thanks to this mechanism, there is no base class — just write regular Python classes!")]),t._v(" "),s("p",[t._v("Here's an example route using class-based view:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Home")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Classes, oh my!'")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("post")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Roger that'")]),t._v("\n")])])]),s("p",[t._v("If the "),s("code",[t._v(".handle()")]),t._v(" method is implemented, all incoming requests are dispatched to it regardless of their HTTP method:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Home")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Post it, get it, put it, delete it.'")]),t._v("\n")])])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("IMPLEMENTATION DETAILS")]),t._v(" "),s("p",[t._v("Bocadillo actually has a "),s("router-link",{attrs:{to:"/api/views.html#view"}},[s("code",[t._v("View")])]),t._v(" base class, but you don't need to subclass it when building class-based views. It only exists as a unique representation to which function- and class-based views are internally converted to.")],1)]),t._v(" "),s("h2",{attrs:{id:"http-methods"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-methods","aria-hidden":"true"}},[t._v("#")]),t._v(" HTTP methods")]),t._v(" "),s("p",[t._v("Which HTTP methods are exposed on a route depends on the view function or class.")]),t._v(" "),s("p",[t._v("On class-based views, HTTP methods are exposed based on the class' methods. For example, the POST method is accepted if and only if the view implements "),s("code",[t._v(".post()")]),t._v(".")]),t._v(" "),s("p",[t._v("On function-based views, you can use the case-insensitive "),s("code",[t._v("methods")]),t._v(" argument to "),s("code",[t._v("@.route()")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"post"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("create_item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ...")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status_code "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("201")]),t._v("\n")])])]),s("p",[t._v("If "),s("code",[t._v("methods")]),t._v(" is not given, only safe HTTP methods are exposed, i.e. "),s("code",[t._v("GET")]),t._v(" and "),s("code",[t._v("HEAD")]),t._v(".")]),t._v(" "),s("p",[t._v("When a non-allowed HTTP method is requested by a client, a "),s("code",[t._v("405 Not Allowed")]),t._v(" error response is automatically returned.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",[t._v("Bocadillo automatically implements the "),s("code",[t._v("HEAD")]),t._v(" method if your route supports "),s("code",[t._v("GET")]),t._v(".")]),t._v(" "),s("p",[t._v("We do this to allow URL checkers and web crawlers to examine endpoints without transferring the full request body.")])]),t._v(" "),s("h2",{attrs:{id:"route-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#route-parameters","aria-hidden":"true"}},[t._v("#")]),t._v(" Route parameters")]),t._v(" "),s("p",[t._v("Route parameters allow a single URL pattern to match a variety of URLs.")]),t._v(" "),s("p",[t._v("A route parameter is defined with the "),s("code",[t._v("{param_name}")]),t._v(" syntax. When a request is made to a matching URL, the parameter value is extracted and passed to the view as a keyword argument.")]),t._v(" "),s("p",[t._v("Consider the following route:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/say/{message}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("say")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string-interpolation"}},[s("span",{pre:!0,attrs:{class:"token string"}},[t._v("f\"You said: '")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"")])]),t._v("\n")])])]),s("p",[t._v("If a request is made to "),s("code",[t._v("/say/hello")]),t._v(", the view will be given a keyword argument "),s("code",[t._v("message")]),t._v(" with the value "),s("code",[t._v('"hello"')]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8000/say/hello"')]),t._v("\n")])])]),s("div",{staticClass:"language-http extra-class"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token response-status"}},[t._v("HTTP/1.1 "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("200 OK")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("date:")]),t._v(" Sat, 18 May 2019 09:35:51 GMT\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("server:")]),t._v(" uvicorn\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-type:")]),t._v(" text/plain\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("content-length:")]),t._v(" 5\n\nYou said: 'hello'\n")])])]),s("h2",{attrs:{id:"validation-and-conversion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#validation-and-conversion","aria-hidden":"true"}},[t._v("#")]),t._v(" Validation and conversion")]),t._v(" "),s("p",[t._v("Bocadillo provides a lightweight "),s("strong",[t._v("route parameter validation mechanism")]),t._v(" based on "),s("a",{attrs:{href:"https://docs.python.org/3/library/typing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("type annotations"),s("OutboundLink")],1),t._v(" and the "),s("a",{attrs:{href:"https://www.encode.io/typesystem/",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeSystem"),s("OutboundLink")],1),t._v(" data validation library.")]),t._v(" "),s("p",[s("strong",[t._v("How it works")]),t._v(": if the route parameter declared on the view has a type annotation, Bocadillo automatically converts the parameter value to that type. If it is not annotated, the value is passed as a string.")]),t._v(" "),s("p",[t._v("For example:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("div",{staticClass:"highlighted"},[t._v(" ")]),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items/{pk}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),s("p",[t._v("By annotating "),s("code",[t._v("pk")]),t._v(" as an "),s("code",[t._v("int")]),t._v(", Bocadillo "),s("em",[t._v("automatically")]),t._v(" converts the extracted "),s("code",[t._v("pk")]),t._v(" parameter to an integer before passing it to the view. It's that simple!")]),t._v(" "),s("p",[t._v("If a parameter cannot be converted, a "),s("code",[t._v("400 Bad Request")]),t._v(" response is returned with an explicit error message. For example:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8000/items/notanumber"')]),t._v("\n")])])]),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"400 Bad Request"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"detail"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pk"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Must be a number."')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("You can also annotate parameters with a "),s("strong",[t._v("TypeSystem field")]),t._v(" directly:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" typesystem "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Integer\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items/{quantity}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_item")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("minimum"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),s("p",[t._v("As it turns out, annotating parameters with builtins such as "),s("code",[t._v("int")]),t._v(" or "),s("code",[t._v("bool")]),t._v(" only works because Bocadillo provides "),s("strong",[t._v("aliases to TypeSystem fields")]),t._v(". Here's the full list of available aliases:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Type annotation")]),t._v(" "),s("th",[t._v("TypeSystem field")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("int")])]),t._v(" "),s("td",[s("code",[t._v("Integer()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("float")])]),t._v(" "),s("td",[s("code",[t._v("Float()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("bool")])]),t._v(" "),s("td",[s("code",[t._v("Boolean()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("decimal.Decimal")])]),t._v(" "),s("td",[s("code",[t._v("Decimal()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("datetime.datetime")])]),t._v(" "),s("td",[s("code",[t._v("DateTime()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("datetime.date")])]),t._v(" "),s("td",[s("code",[t._v("Date()")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("datetime.time")])]),t._v(" "),s("td",[s("code",[t._v("Time()")])])])])]),t._v(" "),s("p",[t._v("See also "),s("a",{attrs:{href:"https://www.encode.io/typesystem/fields/",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeSystem fields"),s("OutboundLink")],1),t._v(" for the complete list of fields and their options.")]),t._v(" "),s("h2",{attrs:{id:"query-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#query-parameters","aria-hidden":"true"}},[t._v("#")]),t._v(" Query parameters")]),t._v(" "),s("p",[t._v("Similarly to route parameters, query parameters present in the URL's "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Query_string",target:"_blank",rel:"noopener noreferrer"}},[t._v("querystring"),s("OutboundLink")],1),t._v(" can be validated and injected into the view.")]),t._v(" "),s("p",[t._v("You can do so by declaring a parameter with a default value, and optionally type-annotating it:")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("ITEMS "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("list")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("range")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/items"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_items")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ITEMS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("limit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" limit "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("is")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" ITEMS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("Here's what the value of "),s("code",[t._v("limit")]),t._v(" will be for various requested URL paths:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("Requested path")]),t._v(" "),s("th",[s("code",[t._v("limit")])])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("/items")])]),t._v(" "),s("td",[s("code",[t._v("None")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("/items?limit=5")])]),t._v(" "),s("td",[s("code",[t._v("5")]),t._v(" (the integer)")])])])]),t._v(" "),s("p",[t._v("Validation works as expected: requesting "),s("code",[t._v("/items?limit=notanumber")]),t._v(" will result in a "),s("code",[t._v("400 Bad Request")]),t._v(" error response.")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"400 Bad Request"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"detail"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"limit"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Must be a number."')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),s("p",[t._v("Raw query parameters can be accessed through the "),s("router-link",{attrs:{to:"/guide/requests.html#query-parameters"}},[t._v("Request object")]),t._v(".")],1)]),t._v(" "),s("h2",{attrs:{id:"wildcard-matching"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wildcard-matching","aria-hidden":"true"}},[t._v("#")]),t._v(" Wildcard matching")]),t._v(" "),s("p",[t._v("Wildcard URL matching is made possible thanks the anonymous parameter "),s("code",[t._v("{}")]),t._v(". This is useful to implement routes that serve as defaults when no other routes match the requested URL path.")]),t._v(" "),s("p",[t._v('For example, here\'s how to implement a "catch-all" route:')]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello, world!"')]),t._v("\n")])])]),s("p",[t._v("As you can see, the value of an anonymous parameter is not passed to the view. If you need access to the value, you should use a regular named route parameter.")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("CAVEATS")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Order matters")]),t._v(". If "),s("code",[t._v("/foo/{}")]),t._v(" is defined before "),s("code",[t._v("/foo/bar")]),t._v(", making a request to "),s("code",[t._v("/foo/bar")]),t._v(" will match "),s("code",[t._v("/foo/{}")]),t._v(". As a rule of thumb, define wildcard routes last.")]),t._v(" "),s("li",[t._v("The anonymous parameter "),s("code",[t._v("{}")]),t._v(" expects a "),s("strong",[t._v("non-empty string")]),t._v(". This means that, unlike the catch-all "),s("code",[t._v("{}")]),t._v(" (which is actually a special case), the pattern "),s("code",[t._v("/{}")]),t._v(" will "),s("em",[t._v("not")]),t._v(" match the root URL "),s("code",[t._v("/")]),t._v(" because it expects a non-empty value after the leading slash.")]),t._v(" "),s("li",[t._v("Wildcard routes should not be used to implement 404 pages — Bocadillo already returns those for you.")])])]),t._v(" "),s("h2",{attrs:{id:"path-like-route-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#path-like-route-parameters","aria-hidden":"true"}},[t._v("#")]),t._v(" Path-like route parameters")]),t._v(" "),s("p",[t._v("If you want a route parameter to match an entire section of the URL, use the "),s("code",[t._v(":path")]),t._v(" converter.")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/images/{location:path}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" location"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),s("p",[t._v("Here, requesting "),s("code",[t._v("/images/news/header.png")]),t._v(" will result in the view being given "),s("code",[t._v('location="news/header.png"')]),t._v(".")]),t._v(" "),s("h2",{attrs:{id:"redirecting"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#redirecting","aria-hidden":"true"}},[t._v("#")]),t._v(" Redirecting")]),t._v(" "),s("p",[t._v("Inside a view, you can redirect to another URL by raising a "),s("code",[t._v("Redirect")]),t._v(" exception. The given URL can be internal (a path relative to the server's host) or external (an absolute URL).")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Redirect\n\n@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" Redirect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/home"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# or, equivalently:")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" Redirect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://localhost:8000/home"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("Redirections are temporary (302) by default. To return a permanent (301) redirection, pass "),s("code",[t._v("permanent=True")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" Redirect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/home"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" permanent"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])},[],!1,null,null,null);a.default=n.exports}}]);