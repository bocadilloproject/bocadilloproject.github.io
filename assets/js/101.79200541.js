(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{489:function(t,a,e){"use strict";e.r(a);var s=e(6),n=Object(s.a)({},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("We're very excited to anounce that Bocadillo v0.14 is out! This release standardises how applications are structured and run, and brings new features that make working with Bocadillo even more productive.")]),t._v(" "),e("p",[t._v("If you have any questions or feedback about this release, feel free to "),e("router-link",{attrs:{to:"/faq.html#getting-in-touch"}},[t._v("get in touch")]),t._v("!")],1),t._v(" "),e("div",{staticClass:"warning custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("IMPORTANT")]),t._v(" "),e("p",[e("strong",[t._v("Bocadillo 0.14.0 is incompatible with 0.13.x and earlier")]),t._v(". We took the decision to introduce breaking changes to improve the API and the overall development workflow. You'll find tips on migrating from 0.13.x in this blog post.")])]),t._v(" "),e("h4",{attrs:{id:"contents"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#contents","aria-hidden":"true"}},[t._v("#")]),t._v(" Contents")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#non-backwards-compatible-changes"}},[t._v("Non backwards-compatible changes")]),e("ul",[e("li",[e("a",{attrs:{href:"#all-async"}},[t._v("All async")])]),e("li",[e("a",{attrs:{href:"#application-configuration"}},[t._v("Application configuration")])]),e("li",[e("a",{attrs:{href:"#serving-apps"}},[t._v("Serving apps")])]),e("li",[e("a",{attrs:{href:"#res-json"}},[t._v("res.json")])]),e("li",[e("a",{attrs:{href:"#redirect-exception"}},[t._v("Redirect exception")])])])]),e("li",[e("a",{attrs:{href:"#new-features"}},[t._v("New features")]),e("ul",[e("li",[e("a",{attrs:{href:"#bocadillo-cli"}},[t._v("Bocadillo CLI")])]),e("li",[e("a",{attrs:{href:"#data-validation"}},[t._v("Data validation")])]),e("li",[e("a",{attrs:{href:"#route-parameter-validation"}},[t._v("Route parameter validation")])]),e("li",[e("a",{attrs:{href:"#query-parameter-injection"}},[t._v("Query parameter injection")])]),e("li",[e("a",{attrs:{href:"#exceptions-in-error-handlers"}},[t._v("Exceptions in error handlers")])])])]),e("li",[e("a",{attrs:{href:"#removed-features"}},[t._v("Removed features")]),e("ul",[e("li",[e("a",{attrs:{href:"#media"}},[t._v("Media")])]),e("li",[e("a",{attrs:{href:"#named-routes"}},[t._v("Named routes")])]),e("li",[e("a",{attrs:{href:"#test-client-with-app-client"}},[t._v("Test client with app.client")])])])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"non-backwards-compatible-changes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#non-backwards-compatible-changes","aria-hidden":"true"}},[t._v("#")]),t._v(" Non backwards-compatible changes")]),t._v(" "),e("h3",{attrs:{id:"all-async"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#all-async","aria-hidden":"true"}},[t._v("#")]),t._v(" All async")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[t._v("tl;dr")]),t._v(" "),e("p",[t._v("From 0.14 and onwards, when in doubt, use "),e("code",[t._v("async def")]),t._v(".")])]),t._v(" "),e("p",[t._v("Since the very first releases, Bocadillo was designed to support both synchronous and asynchronous syntax in a lot of places. This design principle was known as "),e("strong",[t._v("async-first")]),t._v(".")]),t._v(" "),e("p",[t._v("However, this introduced complexity in the framework internals, and it was not clear where async was mandatory and where it was not. We realised that async-first was not the right approach.")]),t._v(" "),e("p",[t._v("For this reason, "),e("strong",[t._v("Bocadillo v0.14 and onwards will be "),e("em",[t._v("all-async")])]),t._v(".")]),t._v(" "),e("p",[t._v("This means that "),e("strong",[t._v("synchronous syntax for the following features is not supported anymore")]),t._v(": function-based HTTP views, methods of class-based HTTP views, error handlers, HTTP middleware callbacks, and HTTP hooks.")]),t._v(" "),e("p",[t._v("For example, you can't write this in Bocadillo v0.14+ anymore:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),e("p",[t._v("Instead, you "),e("em",[t._v("must")]),t._v(" use "),e("code",[t._v("async def")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),e("p",[t._v("To help with the transition:")]),t._v(" "),e("ol",[e("li",[t._v("We've added checks to the framework that detect when you use a regular function whereas an asynchronous one is expected.")]),t._v(" "),e("li",[t._v("We've added an "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/async.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("async crash course"),e("OutboundLink")],1),t._v(" with tips, common patterns, and resources for people getting started with Python async.")])]),t._v(" "),e("p",[t._v("We hope this decision will foster your interest in learning about async Python, and make working with Bocadillo more straight-forward!")]),t._v(" "),e("h3",{attrs:{id:"application-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#application-configuration","aria-hidden":"true"}},[t._v("#")]),t._v(" Application configuration")]),t._v(" "),e("p",[t._v("Before 0.14, configuration was primarily performed via arguments to "),e("code",[t._v("App")]),t._v(", e.g. "),e("code",[t._v("App(enable_hsts=True)")]),t._v(".")]),t._v(" "),e("p",[t._v("This proved to be hardly scalable, because:")]),t._v(" "),e("ul",[e("li",[t._v("More and more parameters were added to "),e("code",[t._v("App")]),t._v(" as we implemented new features.")]),t._v(" "),e("li",[t._v("Decomposing an app into multiple sub-apps required to configure them in the same way — when this didn't cause strange errors because of duplicated configuration.")])]),t._v(" "),e("p",[t._v("To help with this, "),e("strong",[t._v("Bocadillo 0.14 completely changes the way applications are configured")]),t._v(" using a new configuration workflow supported by a lightweight plugin system.")]),t._v(" "),e("div",{staticClass:"tip custom-block"},[e("p",[t._v("This new way of doing things induces some necessary boilerplate, so to help you out we recommend you use the new "),e("a",{attrs:{href:"#bocadillo-cli"}},[t._v("Bocadillo CLI")]),t._v(".")])]),t._v(" "),e("h4",{attrs:{id:"configuration-workflow"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration-workflow","aria-hidden":"true"}},[t._v("#")]),t._v(" Configuration workflow")]),t._v(" "),e("p",[t._v("App configuration is now performed once and for all with the "),e("code",[t._v("bocadillo.configure()")]),t._v(" helper. It accepts various "),e("strong",[t._v("settings")]),t._v(" which are then made accessible anywhere using the "),e("code",[t._v("bocadillo.settings")]),t._v(" object.")]),t._v(" "),e("p",[t._v("As for where and how those settings should be defined, the TL;DR is: use a "),e("strong",[t._v("settings module")]),t._v(".")]),t._v(" "),e("p",[t._v("To learn more, please refer to the new "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/architecture/app.html#configuration",target:"_blank",rel:"noopener noreferrer"}},[t._v("Configuration"),e("OutboundLink")],1),t._v(" guide.")]),t._v(" "),e("h4",{attrs:{id:"plugins"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#plugins","aria-hidden":"true"}},[t._v("#")]),t._v(" Plugins")]),t._v(" "),e("p",[t._v("Plugins are small pieces of functionality which are setup at configuration time.")]),t._v(" "),e("p",[t._v("Many features in Bocadillo are now implemented as plugins. As a result, "),e("strong",[e("code",[t._v("App")]),t._v(" does not take any parameter anymore")]),t._v(". Instead, you should define plugin-specific "),e("strong",[t._v("settings")]),t._v(" in the settings module. These are specified in the "),e("a",{attrs:{href:"https://bocadilloproject.github.io/api/plugins.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("plugins API reference"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("What does this mean in practice? Well, instead of:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# project/app.py")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("enable_hsts"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("Use:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# project/settings.py")]),t._v("\nHSTS "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# project/app.py")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" configure\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" settings\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconfigure"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" settings"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("If this looks like writing more code, it's because it is — except you're now "),e("em",[t._v("doing things right")]),t._v(".")]),t._v(" "),e("p",[t._v("To help with this necessary boilerplate, be sure to check out "),e("a",{attrs:{href:"#bocadillo-cli"}},[t._v("Bocadillo CLI")]),t._v(" and its project creation command.")]),t._v(" "),e("h3",{attrs:{id:"serving-apps"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#serving-apps","aria-hidden":"true"}},[t._v("#")]),t._v(" Serving apps")]),t._v(" "),e("p",[t._v("Previously, the idiomatic way to serve apps was to add")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("at the end of the "),e("code",[t._v("app.py")]),t._v(" script and to run "),e("code",[t._v("$ python app.py")]),t._v(".")]),t._v(" "),e("p",[t._v("We concluded that this early design decision was bad, because:")]),t._v(" "),e("ul",[e("li",[t._v("It increases boilerplate.")]),t._v(" "),e("li",[t._v("The "),e("code",[t._v('if __name__ == "__main__"')]),t._v(" check can be confusing for beginners (and even more seasoned Python developers).")]),t._v(" "),e("li",[e("code",[t._v("app.run()")]),t._v(" was merely a proxy for "),e("code",[t._v("uvicorn.run()")]),t._v(" with little to no added value.")])]),t._v(" "),e("p",[t._v("For this reason, "),e("strong",[e("code",[t._v("app.run()")]),t._v(" has been removed entirely")]),t._v(". This has two consequences:")]),t._v(" "),e("ol",[e("li",[t._v("The official way to serve apps is now to "),e("strong",[t._v("use the "),e("code",[t._v("uvicorn")]),t._v(" command")]),t._v(". See "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/architecture/app.html#serving-an-application",target:"_blank",rel:"noopener noreferrer"}},[t._v("Serving an application"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("li",[e("strong",[t._v("Debug mode has been removed.")]),t._v(" You can enable hot reload using the "),e("code",[t._v("--reload")]),t._v(" option to "),e("code",[t._v("uvicorn")]),t._v(".")])]),t._v(" "),e("p",[t._v("Here's a comparison of the minimum working application with hot reload enabled:")]),t._v(" "),e("ul",[e("li",[t._v("Previously:")])]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# app.py")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"__main__"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("debug"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("python app.py\n")])])]),e("ul",[e("li",[t._v("Now:")])]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" configure\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconfigure"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("uvicorn app:app\n")])])]),e("h3",{attrs:{id:"res-json"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#res-json","aria-hidden":"true"}},[t._v("#")]),t._v(" res.json")]),t._v(" "),e("p",[t._v("Previously, sending a JSON response was performed using "),e("code",[t._v("res.media")]),t._v(". We reckon that this was not very intuitive. Since "),e("a",{attrs:{href:"#media"}},[t._v("media has been removed")]),t._v(", "),e("strong",[t._v("we decided to replace "),e("code",[t._v("res.media")]),t._v(" by the more straight-forward "),e("code",[t._v("res.json")])]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/health-check"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("health_check")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ❌ Previously:")]),t._v("\n    res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("media "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ✅ Now:")]),t._v("\n    res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("json "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OK"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"redirect-exception"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redirect-exception","aria-hidden":"true"}},[t._v("#")]),t._v(" "),e("code",[t._v("Redirect")]),t._v(" exception")]),t._v(" "),e("p",[t._v("Previously, redirecting an HTTP request to another URL was performed using the "),e("code",[t._v("app.redirect()")]),t._v(" helper method. The fact that this method interrupted the execution of a view without a "),e("code",[t._v("return")]),t._v(" or a "),e("code",[t._v("raise")]),t._v(" felt like unnecessary magic. With the removal of "),e("a",{attrs:{href:"#named-routes"}},[t._v("named routes")]),t._v(", we decided to fix this.")]),t._v(" "),e("p",[t._v("Redirections are now performed by raising a "),e("code",[t._v("Redirect")]),t._v(" exception (which is exactly what "),e("code",[t._v("app.redirect()")]),t._v(" did internally). Redirecting to another route by name is not supported anymore: you need to pass the full URL.")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Redirect\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/hello/{name}"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string-interpolation"}},[e("span",{pre:!0,attrs:{class:"token string"}},[t._v('f"Hello, ')]),e("span",{pre:!0,attrs:{class:"token interpolation"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('!"')])]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("index")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ❌ Previously, one of:")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("redirect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Stranger"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("redirect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/hello/Stranger"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ✅ Now:")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" Redirect"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/hello/Stranger"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"new-features"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#new-features","aria-hidden":"true"}},[t._v("#")]),t._v(" New features")]),t._v(" "),e("h3",{attrs:{id:"bocadillo-cli"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bocadillo-cli","aria-hidden":"true"}},[t._v("#")]),t._v(" Bocadillo CLI")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/bocadilloproject/bocadillo-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bocadillo CLI"),e("OutboundLink")],1),t._v(" is a brand new CLI to help with bootstrapping Bocadillo projects. It aims at "),e("strong",[t._v("standardizing")]),t._v(" how Bocadillo projects are structured, and simplify the overall workflow, especially for beginners.")]),t._v(" "),e("p",[t._v("In particular, "),e("code",[t._v("bocadillo create <PROJECT_NAME>")]),t._v(" instantly generates a project with all the files you need to just start writing code, instead of figuring out how files should be structured! 🚀")]),t._v(" "),e("p",[t._v("Digging it? "),e("a",{attrs:{href:"https://github.com/bocadilloproject/bocadillo-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("Give Bocadillo CLI a star!"),e("OutboundLink")],1)]),t._v(" "),e("p",[e("img",{attrs:{src:"https://user-images.githubusercontent.com/15911462/56270267-098d7e80-60f6-11e9-9b76-8434b684e179.png",alt:""}})]),t._v(" "),e("h3",{attrs:{id:"data-validation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#data-validation","aria-hidden":"true"}},[t._v("#")]),t._v(" Data validation")]),t._v(" "),e("p",[t._v("This one is pretty exciting. There's been a gap in the framework as to how JSON data should be validated, and with what tools.")]),t._v(" "),e("p",[t._v("In 0.14, you can now "),e("strong",[t._v("use the "),e("a",{attrs:{href:"https://www.encode.io/typesystem",target:"_blank",rel:"noopener noreferrer"}},[t._v("TypeSystem"),e("OutboundLink")],1),t._v(" library to validate and serialize JSON data")]),t._v(". 🎉")]),t._v(" "),e("p",[t._v("To learn more, read "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/http/json-validation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("JSON validation"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"route-parameter-validation"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#route-parameter-validation","aria-hidden":"true"}},[t._v("#")]),t._v(" Route parameter validation")]),t._v(" "),e("p",[t._v("Route parameters can now be validated using type annotations.")]),t._v(" "),e("p",[t._v("As a result, you can't use format specifiers anymore. So instead of "),e("code",[t._v("{pk:d}")]),t._v(" in the URL pattern, use:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users/{pk}"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_user")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pk"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),e("p",[t._v("For advanced validation use cases, you can annotate the route parameter with a TypeSystem field.")]),t._v(" "),e("p",[t._v("Learn more in "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/http/routing.html#validation-and-conversion",target:"_blank",rel:"noopener noreferrer"}},[t._v("Route parameter validation and conversion"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"query-parameter-injection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#query-parameter-injection","aria-hidden":"true"}},[t._v("#")]),t._v(" Query parameter injection")]),t._v(" "),e("p",[t._v("Besides being available on "),e("code",[t._v("req.query_params")]),t._v(", query parameters can now be injected into the view by declaring them as a parameter with a default.")]),t._v(" "),e("p",[t._v("Bonus points: query parameters injected like this are validated just like route parameters!")]),t._v(" "),e("p",[t._v("As a result, the following code:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_users")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    token "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("query_params"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"token"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("Can be refactored to:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("get_users")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" token"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n")])])]),e("p",[t._v("Learn more in "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/http/routing.html#query-parameters",target:"_blank",rel:"noopener noreferrer"}},[t._v("Query parameters"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"exceptions-in-error-handlers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#exceptions-in-error-handlers","aria-hidden":"true"}},[t._v("#")]),t._v(" Exceptions in error handlers")]),t._v(" "),e("p",[t._v("Exceptions raised within an error handler are now fed back into the error handling pipeline. This allows to build modular and reusable error handlers.")]),t._v(" "),e("p",[t._v("For example, you can now re-raise an "),e("code",[t._v("HTTPError")]),t._v(" in a custom error handler:")]),t._v(" "),e("div",{staticClass:"language-python extra-class"},[e("pre",{pre:!0,attrs:{class:"language-python"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" bocadillo "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" HTTPError\n\napp "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" App"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Nope")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Exception"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("pass")]),t._v("\n\n@app"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("error_handler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Nope"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("on_nope")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("raise")]),t._v(" HTTPError"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" detail"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"We can\'t let you do this!"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("h2",{attrs:{id:"removed-features"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#removed-features","aria-hidden":"true"}},[t._v("#")]),t._v(" Removed features")]),t._v(" "),e("h3",{attrs:{id:"media"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#media","aria-hidden":"true"}},[t._v("#")]),t._v(" Media")]),t._v(" "),e("p",[t._v("The media framework allowed to configure the "),e("em",[t._v("media type")]),t._v(" of an application globally and to abstract the exact serialization via media handlers. This feature brought inner complexity and quirks, and was very rarely used for anything else than JSON, the de-facto standard for Web APIs nowadays.")]),t._v(" "),e("p",[t._v("As a result, "),e("code",[t._v("res.media")]),t._v(", the "),e("code",[t._v("media_type")]),t._v(" parameter to "),e("code",[t._v("App")]),t._v(" as well as "),e("code",[t._v("@app.media_handler")]),t._v(" and "),e("code",[t._v("app.add_media_handler()")]),t._v(" were removed.")]),t._v(" "),e("p",[t._v("To send JSON data in the response, use "),e("a",{attrs:{href:"#res-json"}},[t._v("res.json")]),t._v(" instead.")]),t._v(" "),e("h3",{attrs:{id:"named-routes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#named-routes","aria-hidden":"true"}},[t._v("#")]),t._v(" Named routes")]),t._v(" "),e("p",[t._v("Previously, all HTTP routes were given a name which could be used to reverse URLs via the "),e("code",[t._v("app.url_for()")]),t._v(" helper.")]),t._v(" "),e("p",[t._v("Due to the complexity introduced compared to how useful this shortcut turns out to be, "),e("strong",[t._v("named routes and URL reversion have been removed")]),t._v(". This means that:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("@app.route()")]),t._v(" does not have the "),e("code",[t._v("name")]),t._v(" and "),e("code",[t._v("namespace")]),t._v(" parameters anymore.")]),t._v(" "),e("li",[e("code",[t._v("app.url_for()")]),t._v(" and the "),e("code",[t._v("url_for")]),t._v(" templates variable don't exist anymore.")])]),t._v(" "),e("p",[t._v("If you want the full URL to a view, you'll simply need to build it yourself.")]),t._v(" "),e("h3",{attrs:{id:"test-client-with-app-client"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#test-client-with-app-client","aria-hidden":"true"}},[t._v("#")]),t._v(" Test client with "),e("code",[t._v("app.client")])]),t._v(" "),e("p",[t._v("Accessing the test client via "),e("code",[t._v("app.client")]),t._v(" was deprecated in 0.13. It is now definitively removed. You must use "),e("code",[t._v("bocadillo.create_client()")]),t._v(" instead, as described in "),e("a",{attrs:{href:"https://bocadilloproject.github.io/guides/architecture/testing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Testing"),e("OutboundLink")],1),t._v(".")])])},[],!1,null,null,null);a.default=n.exports}}]);