(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{479:function(t,e,s){"use strict";s.r(e);var a=s(6),n=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"bocadillo-response"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bocadillo-response","aria-hidden":"true"}},[t._v("#")]),t._v(" bocadillo.response")]),t._v(" "),s("h2",{attrs:{id:"response"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#response","aria-hidden":"true"}},[t._v("#")]),t._v(" Response")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("starlette"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("requests"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("The response builder, passed to HTTP views and typically named "),s("code",[t._v("res")]),t._v(".")]),t._v(" "),s("p",[t._v("At the lower-level, "),s("code",[t._v("Response")]),t._v(" behaves like an ASGI application instance:\nit is a callable and accepts "),s("code",[t._v("receive")]),t._v(" and "),s("code",[t._v("send")]),t._v(" as defined in the "),s("a",{attrs:{href:"https://asgi.readthedocs.io/en/latest/specs/main.html#applications",target:"_blank",rel:"noopener noreferrer"}},[t._v("ASGI\nspec"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("Parameters")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("request")]),t._v(":")]),t._v(" "),s("li",[t._v("__the currently processed "),s("code",[t._v("__")]),t._v("::bocadillo.request#Request.")])]),t._v(" "),s("p",[s("strong",[t._v("Attributes")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("content (bytes or str)")]),t._v(": the raw response content.")]),t._v(" "),s("li",[s("code",[t._v("status_code (int)")]),t._v(": the HTTP status code. If not set, defaults to "),s("code",[t._v("200")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("headers (dict)")]),t._v(":\na case-insensitive dictionary of HTTP headers.\nIf not set, "),s("code",[t._v("content-type")]),t._v(" header is set to "),s("code",[t._v("text/plain")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("chunked (bool)")]),t._v(": sets the "),s("code",[t._v("transfer-encoding")]),t._v(" header to "),s("code",[t._v("chunked")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("attachment (str)")]),t._v(":\na file name that this response should be sent as.\nThis is done by setting the "),s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition",target:"_blank",rel:"noopener noreferrer"}},[t._v("Content-Disposition"),s("OutboundLink")],1),t._v(' header, and\ntypically makes the client browser trigger a "Save Asâ€¦" dialog or\ndownload and save the file locally.')])]),t._v(" "),s("h3",{attrs:{id:"html"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#html","aria-hidden":"true"}},[t._v("#")]),t._v(" html")]),t._v(" "),s("p",[t._v("Write-only property that sets "),s("code",[t._v("content")]),t._v(" to the set value and sets the "),s("code",[t._v("Content-Type")]),t._v(" header to "),s("code",[t._v('"text/html"')]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"json"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#json","aria-hidden":"true"}},[t._v("#")]),t._v(" json")]),t._v(" "),s("p",[t._v("Write-only property that sets "),s("code",[t._v("content")]),t._v(" to the JSON-serialized version of the set value, and sets the "),s("code",[t._v("Content-Type")]),t._v(' header to `"application/json".')]),t._v(" "),s("h3",{attrs:{id:"text"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#text","aria-hidden":"true"}},[t._v("#")]),t._v(" text")]),t._v(" "),s("p",[t._v("Write-only property that sets "),s("code",[t._v("content")]),t._v(" to the set value and sets the "),s("code",[t._v("Content-Type")]),t._v(" header to "),s("code",[t._v('"text/plain"')]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#file","aria-hidden":"true"}},[t._v("#")]),t._v(" file")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("str")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" attach"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("Send a file asynchronously using "),s("a",{attrs:{href:"https://github.com/Tinche/aiofiles",target:"_blank",rel:"noopener noreferrer"}},[t._v("aiofiles"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[s("strong",[t._v("Parameters")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("path (str)")]),t._v(":\na path to a file on this machine.")]),t._v(" "),s("li",[s("strong",[t._v("attach (bool, optional)")]),t._v(":\nwhether to send the file as an "),s("a",{attrs:{href:"#response"}},[t._v("attachment")]),t._v(".\nDefaults to "),s("code",[t._v("True")]),t._v(".")])]),t._v(" "),s("h3",{attrs:{id:"background"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#background","aria-hidden":"true"}},[t._v("#")]),t._v(" background")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("background"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Coroutine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Coroutine"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("Register a coroutine function to be executed in the background.")]),t._v(" "),s("p",[t._v("This can be used either as a decorator or a regular function.")]),t._v(" "),s("p",[s("strong",[t._v("Parameters")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("func (callable)")]),t._v(":\na coroutine function.")]),t._v(" "),s("li",[s("strong",[t._v("*args, **kwargs")]),t._v(":\nany positional and keyword arguments to pass to "),s("code",[t._v("func")]),t._v(" when\nexecuting it.")])]),t._v(" "),s("h3",{attrs:{id:"stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#stream","aria-hidden":"true"}},[t._v("#")]),t._v(" stream")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AsyncIterable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("AnyStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" raise_on_disconnect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("bool")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AsyncIterable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("AnyStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("Stream the response.")]),t._v(" "),s("p",[t._v("The decorated function should be a no-argument asynchronous generator\nfunction that yields chunks of the response (strings or bytes).")]),t._v(" "),s("p",[t._v("If "),s("code",[t._v("raise_on_disconnect")]),t._v(" is "),s("code",[t._v("True")]),t._v(",  a "),s("code",[t._v("ClientDisconnect")]),t._v(" exception\nis raised in the generator when it "),s("code",[t._v("yield")]),t._v("s a chunk but the client\nhas disconnected. Otherwise, the exception is handled and the stream\nstops.")]),t._v(" "),s("h3",{attrs:{id:"event-stream"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#event-stream","aria-hidden":"true"}},[t._v("#")]),t._v(" event_stream")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("Response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("event_stream"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" func"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AsyncIterable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("AnyStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("kwargs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Callable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AsyncIterable"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),t._v("AnyStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[t._v("Stream server-sent events.")]),t._v(" "),s("p",[t._v("The decorated function should be a no-argument asynchronous generator\nfunction that yields SSE messages (strings or bytes).\nYou can use the "),s("router-link",{attrs:{to:"/api/sse.html#server-event"}},[t._v("server_event")]),t._v(" helper to\nensure that messages are correctly formatted.")],1),t._v(" "),s("p",[t._v("This is nearly equivalent to "),s("code",[t._v("@stream()")]),t._v(". The only difference is that\nthis decorator also sets SSE-specific HTTP headers:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("Cache-Control: no-cache")])]),t._v(" "),s("li",[s("code",[t._v("Content-Type: text/event-stream")])]),t._v(" "),s("li",[s("code",[t._v("Connection: Keep-Alive")])])]),t._v(" "),s("p",[s("strong",[t._v("See Also")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events",target:"_blank",rel:"noopener noreferrer"}},[t._v("Using server-sent events (MDN)"),s("OutboundLink")],1)])])])},[],!1,null,null,null);e.default=n.exports}}]);